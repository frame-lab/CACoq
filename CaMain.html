<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>CaMain</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library CaMain</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ListSet</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Classes.EquivDec</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Program.Program</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">QArith</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Numbers.BinNums</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.micromega.Lia</span>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Q_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">orderZofNat</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, (<span class="id" title="var">Z.of_nat</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) + <span class="id" title="var">a</span>) # 1 &lt; <span class="id" title="var">Z.of_nat</span> (<span class="id" title="var">S</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) + <span class="id" title="var">a</span> # 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> # 1 &lt; (<span class="id" title="var">z</span> + 1) # 1).<br/>
+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">inject_Z</span> <span class="id" title="var">z</span> &lt; <span class="id" title="var">inject_Z</span> (<span class="id" title="var">z</span> + 1)). <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Zlt_Qlt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lia</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">inject_Z</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
+ <span class="id" title="tactic">assert</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, (<span class="id" title="var">b</span> + <span class="id" title="var">a</span>) # 1 &lt; ((<span class="id" title="var">b</span> + 1) + <span class="id" title="var">a</span>) # 1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Z.add_assoc</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Z.add_comm</span> 1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Z.add_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <span class="id" title="var">Z.of_nat</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) = ((<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">n</span>) + 1)%<span class="id" title="var">Z</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">lia</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">H1</span> ((<span class="id" title="var">S</span> <span class="id" title="var">n</span>))). <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Q_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> <span class="id" title="keyword">Tactic</span> := <span class="id" title="tactic">program_simpl</span>; <span class="id" title="tactic">congruence</span>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Maximal</span> <span class="id" title="keyword">Implicit</span> <span class="id" title="var">Insertion</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Program Instance</span> <span class="id" title="var">option_eqdec</span> <span class="id" title="var">A</span> `(<span class="id" title="var">EqDec</span> <span class="id" title="var">A</span> <span class="id" title="var">eq</span>) : <span class="id" title="var">EqDec</span> (<span class="id" title="var">option</span> <span class="id" title="var">A</span>) <span class="id" title="var">eq</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">equiv_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">a</span>, <span class="id" title="var">Some</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">a</span> == <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">in_left</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span>, <span class="id" title="var">None</span> =&gt; <span class="id" title="var">in_left</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">_</span>, <span class="id" title="var">None</span> | <span class="id" title="var">None</span>, <span class="id" title="var">Some</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Program Instance</span> <span class="id" title="var">pair_eqdec</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> `(<span class="id" title="var">EqDec</span> <span class="id" title="var">A</span> <span class="id" title="var">eq</span>) `(<span class="id" title="var">EqDec</span> <span class="id" title="var">B</span> <span class="id" title="var">eq</span>) : <span class="id" title="var">EqDec</span> (<span class="id" title="var">A</span> * <span class="id" title="var">B</span>) <span class="id" title="var">eq</span> :=<br/>
{<br/>
&nbsp;&nbsp;<span class="id" title="var">equiv_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">a</span>, <span class="id" title="var">b</span>), (<span class="id" title="var">c</span>,<span class="id" title="var">d</span>) =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">a</span> == <span class="id" title="var">c</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">b</span> == <span class="id" title="var">d</span> <span class="id" title="keyword">then</span> <span class="id" title="var">in_left</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">s1_in_s2</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">EqDec</span> <span class="id" title="var">A</span> <span class="id" title="var">eq</span>} (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">set_mem</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">s2</span> &amp;&amp; <span class="id" title="var">s1_in_s2</span> <span class="id" title="var">t</span> <span class="id" title="var">s2</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">set_eq</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">EqDec</span> <span class="id" title="var">A</span> <span class="id" title="var">eq</span>} (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">length</span> <span class="id" title="var">s1</span> == <span class="id" title="var">length</span> <span class="id" title="var">s2</span>) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">s1_in_s2</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">s1_in_s2</span> <span class="id" title="var">s2</span> <span class="id" title="var">s1</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">false</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_eq_sound</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">EqDec</span> <span class="id" title="var">A</span> <span class="id" title="var">eq</span>} : <span class="id" title="keyword">forall</span> <span class="id" title="var">s1</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">A</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">s2</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_eq</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> = <span class="id" title="var">true</span> &lt;-&gt; ((<span class="id" title="var">length</span> <span class="id" title="var">s1</span> = <span class="id" title="var">length</span> <span class="id" title="var">s2</span>))<br/>
&nbsp;&nbsp;&nbsp;/\ <span class="id" title="var">s1_in_s2</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> = <span class="id" title="var">true</span> /\ <span class="id" title="var">s1_in_s2</span> <span class="id" title="var">s2</span> <span class="id" title="var">s1</span> = <span class="id" title="var">true</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">s1</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">s2</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">set_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">s1_in_s2</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">s1</span>) <span class="id" title="var">s2</span>). <span class="id" title="var">case_eq</span> (<span class="id" title="var">s1_in_s2</span> <span class="id" title="var">s2</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">s1</span>)). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">s1</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">s2</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="var">s1_in_s2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">ConstraintAutomata</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">ConstraintAutomata</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <span class="id" title="var">state</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>: <span class="id" title="keyword">Set</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<span class="id" title="var">EqDec</span> <span class="id" title="var">name</span> <span class="id" title="var">eq</span>} `{<span class="id" title="var">EqDec</span> <span class="id" title="var">state</span> <span class="id" title="var">eq</span>} `{<span class="id" title="var">EqDec</span> (<span class="id" title="var">data</span>) <span class="id" title="var">eq</span>}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot; a &lt;? b " := (<span class="id" title="var">negb</span> (<span class="id" title="var">Qle_bool</span> <span class="id" title="var">b</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot;a =? b" := (<span class="id" title="var">Qeq_bool</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">tds</span> := <span class="id" title="var">mktds</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">id</span> : <span class="id" title="var">name</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dataAssignment</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">data</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">timeStamp</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">QArith_base.Q</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tdsCond</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>:<span class="id" title="var">nat</span>, <span class="id" title="var">Qlt</span> (<span class="id" title="var">timeStamp</span> <span class="id" title="var">n</span>) (<span class="id" title="var">timeStamp</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">index</span> : <span class="id" title="var">nat</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tDc</span> : <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dc</span> : <span class="id" title="var">name</span> -&gt; <span class="id" title="var">data</span> -&gt; <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqDc</span> : <span class="id" title="var">name</span> -&gt; <span class="id" title="var">name</span> -&gt; <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> : <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> -&gt; <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> -&gt; <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">orDc</span>  : <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> -&gt; <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> -&gt; <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">trDc</span>  : (<span class="id" title="var">data</span> -&gt; <span class="id" title="var">data</span>) -&gt; <span class="id" title="var">name</span> -&gt; <span class="id" title="var">name</span> -&gt; <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">negDc</span> : <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> -&gt; <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot;a @ b" := (<span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)(<span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 69).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot;a $ b" := (<span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>) (<span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 69).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">evalDC</span> (<span class="id" title="var">po</span>: <span class="id" title="var">option</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">d</span> : <span class="id" title="var">data</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">po</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">p</span>(<span class="id" title="var">index</span> <span class="id" title="var">p</span>) == <span class="id" title="var">d</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">evalDCSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">po</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">d</span>, <span class="id" title="var">evalDC</span> <span class="id" title="var">po</span> <span class="id" title="var">d</span> = <span class="id" title="var">true</span> &lt;-&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>, <span class="id" title="var">po</span> = <span class="id" title="var">Some</span> <span class="id" title="var">x</span> /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dataAssignment</span> <span class="id" title="var">x</span>(<span class="id" title="var">index</span> <span class="id" title="var">x</span>) = <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">po</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">evalDC</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">retrievePortFromInput</span> (<span class="id" title="var">tds</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">n</span>: <span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">tds</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">n</span> == <span class="id" title="var">id</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">Some</span> <span class="id" title="var">a</span> <span class="id" title="keyword">else</span> <span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">t</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">retrievePortFromInputSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">tds</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>: <span class="id" title="var">name</span>,<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds</span> <span class="id" title="var">n</span> = <span class="id" title="var">Some</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">tds</span> /\ <span class="id" title="var">n</span> = <span class="id" title="var">id</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">induction</span> <span class="id" title="var">tds0</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHtds0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">eqDataPorts</span> (<span class="id" title="var">n1</span>: <span class="id" title="var">name</span>) (<span class="id" title="var">n2</span>: <span class="id" title="var">name</span>) (<span class="id" title="var">theta</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">theta</span> <span class="id" title="var">n1</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="keyword">match</span> (<span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">theta</span> <span class="id" title="var">n2</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">a</span>(<span class="id" title="var">index</span> <span class="id" title="var">a</span>)) == (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">b</span>(<span class="id" title="var">index</span> <span class="id" title="var">b</span>)) <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eqDataPortsSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n1</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">n2</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">tds</span> , <span class="id" title="var">eqDataPorts</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> <span class="id" title="var">tds</span> = <span class="id" title="var">true</span> &lt;-&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds</span> <span class="id" title="var">n1</span> = <span class="id" title="var">Some</span> <span class="id" title="var">a</span> /\ <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds</span> <span class="id" title="var">n2</span> = <span class="id" title="var">Some</span> <span class="id" title="var">b</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">a</span>(<span class="id" title="var">index</span> <span class="id" title="var">a</span>)) = (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">b</span>(<span class="id" title="var">index</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">eqDataPorts</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds0</span> <span class="id" title="var">n1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds0</span> <span class="id" title="var">n2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">t0</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">eqDataPorts</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">transformDC</span> (<span class="id" title="var">transform</span>: <span class="id" title="var">data</span> -&gt; <span class="id" title="var">data</span>) (<span class="id" title="var">n1</span>: <span class="id" title="var">name</span>) (<span class="id" title="var">n2</span>: <span class="id" title="var">name</span>) (<span class="id" title="var">tds</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds</span> <span class="id" title="var">n1</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="keyword">match</span> (<span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds</span> <span class="id" title="var">n2</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">transform</span>((<span class="id" title="var">dataAssignment</span> <span class="id" title="var">a</span>(<span class="id" title="var">index</span> <span class="id" title="var">a</span>))) == (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">b</span>(<span class="id" title="var">index</span> <span class="id" title="var">b</span>)) <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">transformDCsound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">transform</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">n1</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">n2</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">tds</span>, <span class="id" title="var">transformDC</span> <span class="id" title="var">transform</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> <span class="id" title="var">tds</span> = <span class="id" title="var">true</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds</span> <span class="id" title="var">n1</span> = <span class="id" title="var">Some</span> <span class="id" title="var">a</span> /\ <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds</span> <span class="id" title="var">n2</span> = <span class="id" title="var">Some</span> <span class="id" title="var">b</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id" title="var">transform</span>((<span class="id" title="var">dataAssignment</span> <span class="id" title="var">a</span>(<span class="id" title="var">index</span> <span class="id" title="var">a</span>))) = (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">b</span>(<span class="id" title="var">index</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">transformDC</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds0</span> <span class="id" title="var">n1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds0</span> <span class="id" title="var">n2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">t0</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">transformDC</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">evalCompositeDc</span> (<span class="id" title="var">tds</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">dc</span>: <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">dc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">evalDC</span> (<span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds</span> <span class="id" title="var">a</span>) (<span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">eqDataPorts</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">tds</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">a</span> &amp;&amp; <span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">a</span> || <span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">trDc</span> <span class="id" title="var">transform</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  =&gt; <span class="id" title="var">transformDC</span> <span class="id" title="var">transform</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">tds</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">negDc</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="var">negb</span> (<span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">evalCompositeDcSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">tds</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">dca</span>: <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>, <span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">dca</span> = <span class="id" title="var">true</span> &lt;-&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dca</span> = <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> \/ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">dca</span> = <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> /\ (<span class="id" title="var">evalDC</span> (<span class="id" title="var">retrievePortFromInput</span> <span class="id" title="var">tds</span> <span class="id" title="var">a</span>) <span class="id" title="var">b</span>) = <span class="id" title="var">true</span> ) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">dca</span> = <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> /\ <span class="id" title="var">eqDataPorts</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">tds</span> = <span class="id" title="var">true</span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">dca</span> = <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> /\ <span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">a</span> &amp;&amp; <span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">b</span> = <span class="id" title="var">true</span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>,<span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">dca</span> = <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> /\ <span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">a</span> || <span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">b</span> = <span class="id" title="var">true</span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="tactic">exists</span> <span class="id" title="var">tr</span>, <span class="id" title="var">dca</span> = <span class="id" title="var">trDc</span> <span class="id" title="var">tr</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> /\ <span class="id" title="var">transformDC</span> <span class="id" title="var">tr</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">tds</span> = <span class="id" title="var">true</span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="var">dca</span> = <span class="id" title="var">negDc</span> <span class="id" title="var">a</span> /\ <span class="id" title="var">negb</span> (<span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">tds</span> <span class="id" title="var">a</span>) = <span class="id" title="var">true</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">dca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">n0</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">dca1</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">dca2</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">dca1</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">dca2</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">n0</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">dca</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">constraintAutomata</span> : <span class="id" title="keyword">Type</span> := <span class="id" title="var">CA</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Q</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">N</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">T</span> : <span class="id" title="var">state</span> -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Q0</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">returnSmallerNumber</span> (<span class="id" title="var">m</span>:<span class="id" title="var">QArith_base.Q</span>) (<span class="id" title="var">l</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">QArith_base.Q</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> ((<span class="id" title="var">a</span> &lt;? <span class="id" title="var">m</span>)) <span class="id" title="keyword">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">returnSmallerNumber</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="keyword">else</span> <span class="id" title="var">returnSmallerNumber</span> <span class="id" title="var">m</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Q_scope</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">returnSmallerNumber_sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>, <span class="id" title="var">returnSmallerNumber</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span> &lt;&gt; <span class="id" title="var">m</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">l</span> &lt;&gt; [] /\ <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> /\ <span class="id" title="var">a</span> &lt;? <span class="id" title="var">m</span> = <span class="id" title="var">true</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">returnSmallerNumber</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">a</span> &lt;? <span class="id" title="var">m</span>). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">destruct</span> <span class="id" title="var">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot;x |&gt; f" := (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 69, <span class="id" title="var">only</span> <span class="id" title="var">parsing</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Q_scope</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">getThetaTimeCandidate</span> (<span class="id" title="var">p</span>:<span class="id" title="var">tds</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">timeStamp</span> <span class="id" title="var">p</span>(<span class="id" title="var">index</span>(<span class="id" title="var">p</span>))].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">getAllThetaTimes</span> (<span class="id" title="var">theta</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">theta</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">getThetaTimeCandidate</span> <span class="id" title="var">a</span>++<span class="id" title="var">getAllThetaTimes</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">getAllThetaTimesSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>, <span class="id" title="var">getAllThetaTimes</span> <span class="id" title="var">s</span> &lt;&gt; [] &lt;-&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">minimum</span> (<span class="id" title="var">l</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">QArith_base.Q</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">returnSmallerNumber</span> (<span class="id" title="var">hd</span> (<span class="id" title="var">Qmake</span> 0 1) <span class="id" title="var">l</span>) (<span class="id" title="var">tl</span> <span class="id" title="var">l</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">nextTime</span> (<span class="id" title="var">theta</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">minimum</span>(<span class="id" title="var">getAllThetaTimes</span> <span class="id" title="var">theta</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">timeStampEqThetaTime</span> (<span class="id" title="var">theta</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">tds</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">timeStamp</span> <span class="id" title="var">a</span>(<span class="id" title="var">index</span> <span class="id" title="var">a</span>) =? <span class="id" title="var">nextTime</span> (<span class="id" title="var">theta</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">timeStampEqThetaTimeSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">timeStampEqThetaTime</span> <span class="id" title="var">s</span> <span class="id" title="var">a</span> = <span class="id" title="var">true</span> &lt;-&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">timeStamp</span> <span class="id" title="var">a</span>(<span class="id" title="var">index</span> <span class="id" title="var">a</span>) =? <span class="id" title="var">nextTime</span> (<span class="id" title="var">s</span>)) = <span class="id" title="var">true</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">timeStampEqThetaTime</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">timeStampEqThetaTime</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">nextNames</span> (<span class="id" title="var">theta</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">theta2</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">theta2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">timeStampEqThetaTime</span> <span class="id" title="var">theta</span> <span class="id" title="var">a</span> ) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">id</span> <span class="id" title="var">a</span> :: <span class="id" title="var">nextNames</span> <span class="id" title="var">theta</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">nextNames</span> <span class="id" title="var">theta</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| []   =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nextNamesSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">theta</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">theta2</span>, <span class="id" title="var">nextNames</span> <span class="id" title="var">theta</span> <span class="id" title="var">theta2</span> &lt;&gt; [] &lt;-&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">theta2</span> /\ <span class="id" title="var">timeStampEqThetaTime</span> <span class="id" title="var">theta</span> <span class="id" title="var">a</span> = <span class="id" title="var">true</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">theta2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">timeStampEqThetaTime</span> <span class="id" title="var">theta</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHtheta2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H4</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-  <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">theta2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">timeStampEqThetaTime</span> <span class="id" title="var">theta</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHtheta2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">thetaN</span> (<span class="id" title="var">theta</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nextNames</span> (<span class="id" title="var">theta</span>) (<span class="id" title="var">theta</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">nextData</span> (<span class="id" title="var">theta</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">theta2</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) : <span class="id" title="tactic">set</span>((<span class="id" title="var">name</span> * <span class="id" title="var">data</span>)) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">theta2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">timeStampEqThetaTime</span> <span class="id" title="var">theta</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">id</span> <span class="id" title="var">a</span>) , (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">a</span>(<span class="id" title="var">index</span>(<span class="id" title="var">a</span>)))) :: <span class="id" title="var">nextData</span> <span class="id" title="var">theta</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">nextData</span> <span class="id" title="var">theta</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| []   =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nextDataSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">theta</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">theta2</span>, <span class="id" title="var">nextData</span> <span class="id" title="var">theta</span> <span class="id" title="var">theta2</span> &lt;&gt; [] &lt;-&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">theta2</span> /\ <span class="id" title="var">timeStampEqThetaTime</span> <span class="id" title="var">theta</span> <span class="id" title="var">a</span> = <span class="id" title="var">true</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">theta2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">timeStampEqThetaTime</span> <span class="id" title="var">theta</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHtheta2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H4</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-  <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">theta2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">timeStampEqThetaTime</span> <span class="id" title="var">theta</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHtheta2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Q_scope</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">derivative</span> (<span class="id" title="var">p</span>: <span class="id" title="var">tds</span>) := <span class="id" title="var">mktds</span> (<span class="id" title="var">id</span> <span class="id" title="var">p</span>) (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">p</span>) (<span class="id" title="var">timeStamp</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tdsCond</span> <span class="id" title="var">p</span>) (<span class="id" title="var">S</span> (<span class="id" title="var">index</span> <span class="id" title="var">p</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derivative_sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>, <span class="id" title="var">derivative</span> <span class="id" title="var">p</span> = <span class="id" title="var">mktds</span> (<span class="id" title="var">id</span> <span class="id" title="var">p</span>) (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">p</span>) (<span class="id" title="var">timeStamp</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tdsCond</span> <span class="id" title="var">p</span>) ( <span class="id" title="var">S</span>(<span class="id" title="var">index</span> <span class="id" title="var">p</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">derivativePortInvolved</span> (<span class="id" title="var">s</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">a</span>: <span class="id" title="var">tds</span>)  :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; [<span class="id" title="var">a</span>] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">x</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">x</span> == <span class="id" title="var">id</span> <span class="id" title="var">a</span> <span class="id" title="keyword">then</span> [<span class="id" title="var">derivative</span>(<span class="id" title="var">a</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">derivativePortInvolved</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">allDerivativesFromPortsInvolved</span> (<span class="id" title="var">names</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">theta</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) : <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">flat_map</span> (<span class="id" title="var">derivativePortInvolved</span> <span class="id" title="var">names</span>) <span class="id" title="var">theta</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">portsDerivative</span> (<span class="id" title="var">names</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">theta</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">allDerivativesFromPortsInvolved</span> <span class="id" title="var">names</span> <span class="id" title="var">theta</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">portsOutsideTransition</span> (<span class="id" title="var">p</span>: <span class="id" title="var">tds</span>) (<span class="id" title="var">portNames</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">portNames</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">id</span> <span class="id" title="var">p</span> &lt;&gt; <span class="id" title="var">a</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">portsOutsideTransition</span> <span class="id" title="var">p</span> <span class="id" title="var">t</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">portsOutsideTransitionSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">portNames</span>, <span class="id" title="var">portsOutsideTransition</span> <span class="id" title="var">p</span> <span class="id" title="var">portNames</span> = <span class="id" title="var">false</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">In</span> <span class="id" title="var">b</span> <span class="id" title="var">portNames</span> /\ (<span class="id" title="var">id</span> <span class="id" title="var">p</span> = <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">portNames</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">nequiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHportNames</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">portNames</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">nequiv_dec</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHportNames</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">step'</span> (<span class="id" title="var">theta</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">portNames</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transitions</span>: <span class="id" title="tactic">set</span>(<span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">transitions</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">set_eq</span> (<span class="id" title="var">portNames</span>)((<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>))))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id" title="var">evalCompositeDc</span> (<span class="id" title="var">theta</span>) (<span class="id" title="var">snd</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)))) <span class="id" title="keyword">then</span> <span class="id" title="var">snd</span>(<span class="id" title="var">a</span>)::<span class="id" title="var">step'</span> <span class="id" title="var">theta</span> <span class="id" title="var">portNames</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">step'</span> <span class="id" title="var">theta</span> <span class="id" title="var">portNames</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">SCTypes</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tSc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqSc</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">evalSC</span> (<span class="id" title="var">condVal</span>: <span class="id" title="var">nat</span>) (<span class="id" title="var">val</span>: <span class="id" title="var">nat</span>): <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">condVal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">condVal</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">condVal</span> == <span class="id" title="var">val</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
      Record FlowFunction : Type := FF {
        I : nat;
        FUNC : nat -&gt; nat;
        CurrentValue : nat;
        FinalValue : nat;
      }.
    
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">FlowFunction</span> : <span class="id" title="keyword">Type</span> := <span class="id" title="var">FF</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">I</span> : <span class="id" title="var">nat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FUNC</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">nat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">CurrentValue</span> : <span class="id" title="var">nat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FinalValue</span> : <span class="id" title="var">nat</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">step'</span> (<span class="id" title="var">theta</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">portNames</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transitions</span>: <span class="id" title="tactic">set</span>(<span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) (<span class="id" title="var">flowBind</span>: (<span class="id" title="var">state</span> -&gt; <span class="id" title="var">FlowFunction</span>)) : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">transitions</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">set_eq</span> (<span class="id" title="var">portNames</span>)((<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>))))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id" title="var">evalCompositeDc</span> (<span class="id" title="var">theta</span>) (<span class="id" title="var">snd</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)))) &amp;&amp; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">evalSC</span> ((<span class="id" title="var">flowBind</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>))).(<span class="id" title="var">FinalValue</span>)) ((<span class="id" title="var">flowBind</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>))).(<span class="id" title="var">CurrentValue</span>))) <span class="id" title="keyword">then</span> <span class="id" title="var">snd</span>(<span class="id" title="var">a</span>)::<span class="id" title="var">step'</span> <span class="id" title="var">theta</span> <span class="id" title="var">portNames</span> <span class="id" title="var">t</span> <span class="id" title="var">flowBind</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">step'</span> <span class="id" title="var">theta</span> <span class="id" title="var">portNames</span> <span class="id" title="var">t</span> <span class="id" title="var">flowBind</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">step'_sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">theta</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">portNames</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">transitions</span>, <span class="id" title="var">step'</span> <span class="id" title="var">theta</span> <span class="id" title="var">portNames</span> <span class="id" title="var">transitions</span> &lt;&gt; [] -&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">transitions</span> /\ (<span class="id" title="var">set_eq</span> (<span class="id" title="var">portNames</span>)((<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id" title="var">evalCompositeDc</span> (<span class="id" title="var">theta</span>) (<span class="id" title="var">snd</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)))) = <span class="id" title="var">true</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">transitions</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">set_eq</span> (<span class="id" title="var">portNames</span>)((<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>))))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">evalCompositeDc</span> <span class="id" title="var">theta</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">fst</span> <span class="id" title="var">a</span>))). <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHtransitions</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHtransitions</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">stepAux</span> (<span class="id" title="var">ca</span>:<span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">theta</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">portNames</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">s</span>: <span class="id" title="var">state</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="tactic">set</span> <span class="id" title="var">state</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">step'</span> <span class="id" title="var">theta</span> <span class="id" title="var">portNames</span> (<span class="id" title="var">T</span> <span class="id" title="var">ca</span> <span class="id" title="var">s</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">stepa</span> (<span class="id" title="var">ca</span>:<span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">s</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) (<span class="id" title="var">theta</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">portNames</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="tactic">set</span> <span class="id" title="var">state</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">portNames</span>, <span class="id" title="var">flat_map</span> (<span class="id" title="var">stepAux</span> <span class="id" title="var">ca</span> <span class="id" title="var">theta</span> <span class="id" title="var">portNames</span>) <span class="id" title="var">s</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">step</span> (<span class="id" title="var">ca</span>:<span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">s</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) (<span class="id" title="var">theta</span>:<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="tactic">set</span> <span class="id" title="var">state</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">stepa</span> <span class="id" title="var">ca</span> <span class="id" title="var">s</span> <span class="id" title="var">theta</span> (<span class="id" title="var">thetaN</span> <span class="id" title="var">theta</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">run'</span> (<span class="id" title="var">ca</span>:<span class="id" title="var">constraintAutomata</span>)  : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span> -&gt; <span class="id" title="var">nat</span> -&gt; <span class="id" title="tactic">set</span> <span class="id" title="var">state</span> -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">theta</span> <span class="id" title="var">k</span> <span class="id" title="var">initialStates</span> <span class="id" title="var">trace</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">k</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">trace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">m</span> =&gt; <span class="id" title="var">trace</span> ++ [<span class="id" title="var">snd</span> (<span class="id" title="var">step</span> <span class="id" title="var">ca</span> <span class="id" title="var">initialStates</span> <span class="id" title="var">theta</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&gt; <span class="id" title="keyword">rec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">flat_map</span>(<span class="id" title="var">derivativePortInvolved</span>(<span class="id" title="var">fst</span>((<span class="id" title="var">step</span> <span class="id" title="var">ca</span> <span class="id" title="var">initialStates</span> <span class="id" title="var">theta</span>)))) <span class="id" title="var">theta</span>) <span class="id" title="var">m</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">step</span> <span class="id" title="var">ca</span> <span class="id" title="var">initialStates</span> <span class="id" title="var">theta</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">run</span> (<span class="id" title="var">ca</span>:<span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">theta</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">run'</span> <span class="id" title="var">ca</span> <span class="id" title="var">theta</span> <span class="id" title="var">k</span> (<span class="id" title="var">Q0</span> <span class="id" title="var">ca</span>) [<span class="id" title="var">Q0</span> <span class="id" title="var">ca</span>].<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">tdsDerivate</span> (<span class="id" title="var">ca</span>:<span class="id" title="var">constraintAutomata</span>)  : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">tds</span> -&gt; <span class="id" title="var">nat</span> -&gt; <span class="id" title="tactic">set</span> <span class="id" title="var">state</span> -&gt; <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">theta</span> <span class="id" title="var">k</span> <span class="id" title="var">initialStates</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">k</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">theta</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">m</span> =&gt; <span class="id" title="keyword">rec</span> (<span class="id" title="var">flat_map</span> (<span class="id" title="var">derivativePortInvolved</span>(<span class="id" title="var">fst</span>((<span class="id" title="var">step</span> <span class="id" title="var">ca</span> <span class="id" title="var">initialStates</span> <span class="id" title="var">theta</span>)))) <span class="id" title="var">theta</span>) <span class="id" title="var">m</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">step</span> <span class="id" title="var">ca</span> <span class="id" title="var">initialStates</span> <span class="id" title="var">theta</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lastReachedStates</span> (<span class="id" title="var">ca</span>:<span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">theta</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) (<span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">last</span> (<span class="id" title="var">run</span> <span class="id" title="var">ca</span> <span class="id" title="var">theta</span> <span class="id" title="var">k</span>) (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">ca</span>).<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">retrievePortsFromRespTransitions</span> (<span class="id" title="var">s</span> : <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">set_union</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">fst</span> <span class="id" title="var">a</span>) ) (<span class="id" title="var">retrievePortsFromRespTransitions</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">portsOfTransition</span> (<span class="id" title="var">ca</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">state</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">retrievePortsFromRespTransitions</span> (<span class="id" title="var">ConstraintAutomata.T</span> <span class="id" title="var">ca</span> <span class="id" title="var">s</span>).<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">rejecting</span> (<span class="id" title="var">ca</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">theta</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">k</span>, (<span class="id" title="var">lastReachedStates</span> <span class="id" title="var">ca</span> <span class="id" title="var">theta</span> <span class="id" title="var">k</span>) = [].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">calcIndex</span> (<span class="id" title="var">k</span>: <span class="id" title="var">nat</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">tds</span>) := <span class="id" title="var">mktds</span> (<span class="id" title="var">id</span> <span class="id" title="var">p</span>) (<span class="id" title="var">dataAssignment</span> <span class="id" title="var">p</span>) (<span class="id" title="var">timeStamp</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tdsCond</span> <span class="id" title="var">p</span>) (<span class="id" title="var">k</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">accepting'</span> (<span class="id" title="var">ca</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">theta</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">tds</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">q</span>,<span class="id" title="keyword">forall</span> <span class="id" title="var">k</span>, <span class="id" title="var">stepAux</span> <span class="id" title="var">ca</span> (<span class="id" title="var">map</span>(<span class="id" title="var">calcIndex</span> <span class="id" title="var">k</span>) (<span class="id" title="var">theta</span>)) (<span class="id" title="var">thetaN</span> (<span class="id" title="var">map</span>(<span class="id" title="var">calcIndex</span> <span class="id" title="var">k</span>) (<span class="id" title="var">theta</span>))) <span class="id" title="var">q</span> &lt;&gt; [].<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">getTransition</span> (<span class="id" title="var">portNames</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">t2</span> : <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span>(<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; [] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">set_eq</span> <span class="id" title="var">portNames</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)))) <span class="id" title="keyword">then</span> <span class="id" title="var">a</span>::<span class="id" title="var">getTransition</span> <span class="id" title="var">portNames</span> <span class="id" title="var">t</span> <span class="id" title="keyword">else</span> <span class="id" title="var">getTransition</span> <span class="id" title="var">portNames</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">getReachedStatesFromPair</span> (<span class="id" title="var">t1</span> : (<span class="id" title="tactic">set</span>(<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) (<span class="id" title="var">setT2</span> : <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span>(<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setT2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">nextT2</span> =&gt;  <span class="id" title="var">set_add</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">t1</span>),<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">getReachedStatesFromPair</span> <span class="id" title="var">t1</span> <span class="id" title="var">nextT2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">iterateTransitionsQ1A1</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">q1</span>: <span class="id" title="var">state</span>) (<span class="id" title="var">q2</span>: <span class="id" title="var">state</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setT1</span> : <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span>(<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) (<span class="id" title="var">setT2</span>: <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span>(<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">acc</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setT1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; (<span class="id" title="var">q1</span>,<span class="id" title="var">q2</span>)::<span class="id" title="var">acc</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">set_eq</span> ((<span class="id" title="var">getReachedStatesFromPair</span> (<span class="id" title="var">a</span>) (<span class="id" title="var">getTransition</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>))) (<span class="id" title="var">setT2</span>)))) ([]) <span class="id" title="keyword">then</span> [] <span class="id" title="keyword">else</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">getReachedStatesFromPair</span> (<span class="id" title="var">a</span>) (<span class="id" title="var">getTransition</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>))) (<span class="id" title="var">setT2</span>))))++ <span class="id" title="var">iterateTransitionsQ1A1</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">t</span> <span class="id" title="var">setT2</span> <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">iterateOverNextStates</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">acc</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">states</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">states</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">iterateTransitionsQ1A1</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">ConstraintAutomata.T</span> <span class="id" title="var">ca1</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ConstraintAutomata.T</span> <span class="id" title="var">ca2</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>))) <span class="id" title="var">acc</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">bisimilarStatesCa1ToCa2</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">q1</span>: <span class="id" title="var">state</span>) (<span class="id" title="var">q2</span>: <span class="id" title="var">state</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setT1</span> : <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span>(<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) (<span class="id" title="var">setT2</span>: <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span>(<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">acc</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setT1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; (<span class="id" title="var">q1</span>,<span class="id" title="var">q2</span>)::<span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">set_eq</span> ((<span class="id" title="var">getReachedStatesFromPair</span> (<span class="id" title="var">a</span>) (<span class="id" title="var">getTransition</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>))) (<span class="id" title="var">setT2</span>)))) ([]) <span class="id" title="keyword">then</span> [] <span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bisimilarStatesCa1ToCa2</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">t</span> <span class="id" title="var">setT2</span> <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">retrieveCleanStates</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">acc</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) (<span class="id" title="var">states</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">states</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">set_union</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">bisimilarStatesCa1ToCa2</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">ConstraintAutomata.T</span> <span class="id" title="var">ca1</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>))) (<span class="id" title="var">ConstraintAutomata.T</span> <span class="id" title="var">ca2</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>))) <span class="id" title="var">acc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">retrieveCleanStates</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">acc</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">evaluateObtainedStates</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) : <span class="id" title="var">nat</span> -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>) -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">steps</span> <span class="id" title="var">acc</span> <span class="id" title="var">nextPairStates</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">steps</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt;  <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_union</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="keyword">rec</span> <span class="id" title="var">n</span> <span class="id" title="var">acc</span> (<span class="id" title="var">iterateOverNextStates</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">acc</span> <span class="id" title="var">nextPairStates</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">retrieveCleanStates</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">acc</span> ((<span class="id" title="var">iterateOverNextStates</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">acc</span> <span class="id" title="var">nextPairStates</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">iterateOverA2States</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">q1</span>: <span class="id" title="var">state</span>) (<span class="id" title="var">q2</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">acc</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">q2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">evaluateObtainedStates</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> (<span class="id" title="var">length</span>(<span class="id" title="var">ConstraintAutomata.Q</span>(<span class="id" title="var">ca1</span>))) <span class="id" title="var">acc</span> [(<span class="id" title="var">q1</span>,<span class="id" title="var">a</span>)]  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">iterateOverA2States</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">q1</span> <span class="id" title="var">t</span> <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">iterateOverA1States</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">q1</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span>)) (<span class="id" title="var">q2</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span>)) <br/>
&nbsp;&nbsp;(<span class="id" title="var">acc</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">q1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">iterateOverA2States</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">a</span> <span class="id" title="var">q2</span> <span class="id" title="var">acc</span> ++ <span class="id" title="var">iterateOverA1States</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">t</span> <span class="id" title="var">q2</span> <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">containsSymmetric</span> (<span class="id" title="var">setPairs</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) (<span class="id" title="var">setPairsFull</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)):=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setPairs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">q1</span>,<span class="id" title="var">q2</span>) =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">existsb</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>) =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|(<span class="id" title="var">a</span>,<span class="id" title="var">b</span>) =&gt; (<span class="id" title="var">equiv_decb</span> <span class="id" title="var">a</span> <span class="id" title="var">q2</span>) &amp;&amp; (<span class="id" title="var">equiv_decb</span> <span class="id" title="var">b</span> <span class="id" title="var">q1</span>)  <span class="id" title="keyword">end</span>) (<span class="id" title="var">setPairsFull</span>) <span class="id" title="keyword">then</span> (<span class="id" title="var">q1</span>,<span class="id" title="var">q2</span>)::<span class="id" title="var">containsSymmetric</span> <span class="id" title="var">t</span> <span class="id" title="var">setPairsFull</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">containsSymmetric</span> <span class="id" title="var">t</span> <span class="id" title="var">setPairsFull</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">bisimulationAux</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">iterateOverA1States</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">ca1</span>) (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">ca2</span>) []) ++ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">iterateOverA1States</span> <span class="id" title="var">ca2</span> <span class="id" title="var">ca1</span> (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">ca2</span>) (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">ca1</span>) []).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bisimulationAuxCommutative</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ca1</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">ca2</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">In</span> <span class="id" title="var">a</span> (<span class="id" title="var">bisimulationAux</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span>)) &lt;-&gt; (<span class="id" title="var">In</span> <span class="id" title="var">a</span> (<span class="id" title="var">bisimulationAux</span> <span class="id" title="var">ca2</span> <span class="id" title="var">ca1</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">bisimulationAux</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">bisimulationAux</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_or_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">in_app_or</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">bisimulationAux</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">bisimulationAux</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_or_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">in_app_or</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">isSymmetricAux</span> (<span class="id" title="var">setPairs</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) (<span class="id" title="var">setPairsFull</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_eq</span> (<span class="id" title="var">setPairs</span>) (<span class="id" title="var">containsSymmetric</span> (<span class="id" title="var">setPairs</span>) <span class="id" title="var">setPairsFull</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">isSymmetric</span> (<span class="id" title="var">setPairs</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">isSymmetricAux</span> (<span class="id" title="var">setPairs</span>) (<span class="id" title="var">setPairs</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">setPairs</span> <span class="id" title="keyword">else</span> [].<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">isBisim</span> (<span class="id" title="var">setPairs</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isSymmetric</span> <span class="id" title="var">setPairs</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">bisimulation</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isBisim</span> (<span class="id" title="var">bisimulationAux</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">mountSubsetFromPairs</span> (<span class="id" title="var">pairStates</span> : <span class="id" title="var">state</span>) (<span class="id" title="var">setPairs</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setPairs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; [<span class="id" title="var">pairStates</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>) == <span class="id" title="var">pairStates</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">set_add</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">mountSubsetFromPairs</span> <span class="id" title="var">pairStates</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">mountSubsetFromPairs</span> <span class="id" title="var">pairStates</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">getQrelR</span> (<span class="id" title="var">setRel</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setRel</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt;  <span class="id" title="var">set_add</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">mountSubsetFromPairs</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">setRel</span>)) (<span class="id" title="var">getQrelR</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">getReachedDcs</span> (<span class="id" title="var">t</span>: <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> * <span class="id" title="var">state</span>)) (<span class="id" title="var">setStates</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">set_mem</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">setStates</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)))::(<span class="id" title="var">getReachedDcs</span> <span class="id" title="var">t</span> <span class="id" title="var">setStates</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> (<span class="id" title="var">getReachedDcs</span> <span class="id" title="var">t</span> <span class="id" title="var">setStates</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">orDcs</span> (<span class="id" title="var">dc</span> : <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">dc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">ConstraintAutomata.orDc</span> (<span class="id" title="var">ConstraintAutomata.negDc</span> (<span class="id" title="var">orDcs</span> <span class="id" title="var">a</span>)) (<span class="id" title="var">ConstraintAutomata.negDc</span>(<span class="id" title="var">orDcs</span> <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">dc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">disjunctionOfDcs</span> (<span class="id" title="var">setDcs</span> : <span class="id" title="tactic">set</span>(<span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>))  :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setDcs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">ConstraintAutomata.negDc</span>(<span class="id" title="var">ConstraintAutomata.tDc</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; (<span class="id" title="var">ConstraintAutomata.orDc</span> (<span class="id" title="var">orDcs</span> <span class="id" title="var">a</span>) (<span class="id" title="var">disjunctionOfDcs</span> <span class="id" title="var">t</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; (<span class="id" title="var">ConstraintAutomata.orDc</span> (<span class="id" title="var">a</span>) (<span class="id" title="var">disjunctionOfDcs</span> <span class="id" title="var">t</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">dcsOfState</span> (<span class="id" title="var">ca</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">q</span>: <span class="id" title="var">state</span>) (<span class="id" title="var">portNames</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">P</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">disjunctionOfDcs</span>((<span class="id" title="var">getReachedDcs</span> (<span class="id" title="var">getTransition</span> (<span class="id" title="var">portNames</span>) (<span class="id" title="var">ConstraintAutomata.T</span> <span class="id" title="var">ca</span> <span class="id" title="var">q</span>))) (<span class="id" title="var">P</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<span class="id" title="var">EqDec</span> (<span class="id" title="var">data</span> -&gt; <span class="id" title="var">data</span>) <span class="id" title="var">eq</span>}.<br/>

<br/>
<span class="id" title="keyword">Program Instance</span> <span class="id" title="var">dc_eqDec</span> `(<span class="id" title="var">EqDec</span> <span class="id" title="var">name</span> <span class="id" title="var">eq</span>) `(<span class="id" title="var">EqDec</span> <span class="id" title="var">data</span> <span class="id" title="var">eq</span>)  : <span class="id" title="var">EqDec</span> (<span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>) <span class="id" title="var">eq</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">equiv_dec</span> := <span class="id" title="keyword">fix</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">dc1</span> <span class="id" title="var">dc2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">dc1</span>,<span class="id" title="var">dc2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">in_left</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">dc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">a</span> == <span class="id" title="var">c</span> <span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="var">b</span> == <span class="id" title="var">d</span> <span class="id" title="keyword">then</span> <span class="id" title="var">in_left</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">a</span> == <span class="id" title="var">c</span> <span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="var">b</span> == <span class="id" title="var">d</span> <span class="id" title="keyword">then</span> <span class="id" title="var">in_left</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">andDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span> <span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">b</span> <span class="id" title="var">d</span> <span class="id" title="keyword">then</span> <span class="id" title="var">in_left</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">orDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span> <span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">b</span> <span class="id" title="var">d</span> <span class="id" title="keyword">then</span> <span class="id" title="var">in_left</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">negDc</span> <span class="id" title="var">a</span>, <span class="id" title="var">negDc</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">in_left</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">trDc</span> <span class="id" title="var">g</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="var">a</span> == <span class="id" title="var">c</span> <span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="var">b</span> == <span class="id" title="var">d</span> <span class="id" title="keyword">then</span> <span class="id" title="var">in_left</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span> <span class="id" title="keyword">else</span> <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> , <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> , <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> , <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> | <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> , <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> , <span class="id" title="var">negDc</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> , <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">in_right</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">andDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">orDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">negDc</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">dc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">andDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">orDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">negDc</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">dc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">orDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">negDc</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">dc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">andDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">negDc</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>  , <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">negDc</span> <span class="id" title="var">a</span>  , <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">negDc</span> <span class="id" title="var">a</span>  , <span class="id" title="var">dc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">negDc</span> <span class="id" title="var">a</span>  , <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">negDc</span> <span class="id" title="var">a</span>  , <span class="id" title="var">andDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">negDc</span> <span class="id" title="var">a</span>  , <span class="id" title="var">orDc</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">negDc</span> <span class="id" title="var">a</span>  , <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> , <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> , <span class="id" title="var">dc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> , <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> , <span class="id" title="var">andDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> , <span class="id" title="var">orDc</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> , <span class="id" title="var">negDc</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">in_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">dismantleDc</span> (<span class="id" title="var">dc</span>: <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">dc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; [<span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; [<span class="id" title="var">eqDc</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; [<span class="id" title="var">dc</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">negDc</span> <span class="id" title="var">a</span> =&gt; [<span class="id" title="var">negDc</span> <span class="id" title="var">a</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; [<span class="id" title="var">trDc</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">orDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> | <span class="id" title="var">andDc</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">set_union</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">dismantleDc</span> <span class="id" title="var">a</span>) (<span class="id" title="var">dismantleDc</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">existsComplementOrTrue</span> (<span class="id" title="var">setDc</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setDc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">set_mem</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">negDc</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">setDc</span>)) <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> (<span class="id" title="var">existsComplementOrTrue</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">existsComplementOrTrueSound</span>  : <span class="id" title="keyword">forall</span> <span class="id" title="var">setDc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsComplementOrTrue</span> <span class="id" title="var">setDc</span> = <span class="id" title="var">true</span> -&gt; <span class="id" title="var">In</span> (<span class="id" title="var">tDc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">setDc</span> \/ (<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="var">In</span> (<span class="id" title="var">a</span>) (<span class="id" title="var">setDc</span>) /\ <span class="id" title="var">In</span> (<span class="id" title="var">negDc</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">setDc</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">setDc</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">set_mem</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">ha</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_mem_correct1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">set_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">dc</span> <span class="id" title="var">n</span> <span class="id" title="var">d</span>). <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHsetDc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">set_mem</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">ha</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_mem_correct1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">set_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">eqDc</span> <span class="id" title="var">data</span> <span class="id" title="var">n</span> <span class="id" title="var">n0</span>). <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHsetDc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">set_mem</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">ha</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_mem_correct1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">set_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">a1</span> @ <span class="id" title="var">a2</span>). <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHsetDc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">set_mem</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">ha</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_mem_correct1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">set_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">a1</span> $ <span class="id" title="var">a2</span>) . <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHsetDc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">set_mem</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">ha</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_mem_correct1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">set_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">trDc</span> <span class="id" title="var">d</span> <span class="id" title="var">n</span> <span class="id" title="var">n0</span>). <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHsetDc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">negDc</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">set_mem</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">ha</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_mem_correct1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">set_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">negDc</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ha</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHsetDc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">areEquivalentAux</span> (<span class="id" title="var">dc1</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>)) (<span class="id" title="var">dc2</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_eq</span> ((<span class="id" title="var">dc1</span>)) ((<span class="id" title="var">dc2</span>)) || <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">existsComplementOrTrue</span> <span class="id" title="var">dc1</span>) &amp;&amp; (<span class="id" title="var">existsComplementOrTrue</span> <span class="id" title="var">dc2</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">areEquivalent</span> (<span class="id" title="var">dc1</span> : <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>) (<span class="id" title="var">dc2</span>: <span class="id" title="var">DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">areEquivalentAux</span> (<span class="id" title="var">dismantleDc</span> <span class="id" title="var">dc1</span>) (<span class="id" title="var">dismantleDc</span> <span class="id" title="var">dc2</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">powerset</span> (<span class="id" title="var">s</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">concat</span> (<span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> =&gt; [<span class="id" title="var">a</span>::<span class="id" title="var">f</span>;<span class="id" title="var">f</span>]) (<span class="id" title="var">powerset</span> <span class="id" title="var">t</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compareDcBisimPortName</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">q1</span>: <span class="id" title="var">state</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">q2</span>: <span class="id" title="var">state</span>) (<span class="id" title="var">P</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) (<span class="id" title="var">setNames</span>: <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> <span class="id" title="var">name</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setNames</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">areEquivalent</span>((<span class="id" title="var">dcsOfState</span> (<span class="id" title="var">ca1</span>) (<span class="id" title="var">q1</span>) <span class="id" title="var">a</span> <span class="id" title="var">P</span>)) ((<span class="id" title="var">dcsOfState</span> (<span class="id" title="var">ca2</span>) (<span class="id" title="var">q2</span>) <span class="id" title="var">a</span> <span class="id" title="var">P</span>)) &amp;&amp; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compareDcBisimPortName</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">P</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compareDcBisimPartition</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">q1</span>: <span class="id" title="var">state</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">q2</span>: <span class="id" title="var">state</span>) (<span class="id" title="var">setNames</span>: <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> <span class="id" title="var">name</span>)) (<span class="id" title="var">qMinusR</span> : <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> <span class="id" title="var">state</span>)):=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">qMinusR</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; (<span class="id" title="var">compareDcBisimPortName</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">a</span> <span class="id" title="var">setNames</span>) &amp;&amp; (<span class="id" title="var">compareDcBisimPartition</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">setNames</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compareDcBisimStates</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">setNames</span>: <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> <span class="id" title="var">name</span>)) (<span class="id" title="var">qMinusR</span> : <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> <span class="id" title="var">state</span>)) (<span class="id" title="var">pairStates</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">pairStates</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt;  (<span class="id" title="var">compareDcBisimPartition</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>)) <span class="id" title="var">setNames</span> <span class="id" title="var">qMinusR</span>) &amp;&amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compareDcBisimStates</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> <span class="id" title="var">setNames</span> <span class="id" title="var">qMinusR</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">statesA1InSetPairStates</span> (<span class="id" title="var">setPairStates</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setPairStates</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">set_add</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">statesA1InSetPairStates</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">statesA2InSetPairStates</span> (<span class="id" title="var">setPairStates</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">setPairStates</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="var">set_add</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">a</span>)) (<span class="id" title="var">statesA2InSetPairStates</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">containsAllStatesOfBothCa</span> (<span class="id" title="var">setQ1</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) (<span class="id" title="var">setQ2</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) (<span class="id" title="var">setBisim</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">s1_in_s2</span> (<span class="id" title="var">setQ1</span>) (<span class="id" title="var">statesA1InSetPairStates</span> <span class="id" title="var">setBisim</span>)) &amp;&amp; (<span class="id" title="var">s1_in_s2</span> (<span class="id" title="var">setQ2</span>) (<span class="id" title="var">statesA2InSetPairStates</span> <span class="id" title="var">setBisim</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">checkBisimilarity</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">bisimRelation</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">set_eq</span> (<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">ca1</span>) (<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">ca2</span>)) &amp;&amp; (<span class="id" title="var">negb</span>(<span class="id" title="var">equiv_decb</span> (<span class="id" title="var">bisimRelation</span>) ([]))) <span class="id" title="keyword">then</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">compareDcBisimStates</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> (<span class="id" title="var">powerset</span> (<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">ca1</span>)) (<span class="id" title="var">getQrelR</span> (<span class="id" title="var">bisimRelation</span>)) (<span class="id" title="var">bisimRelation</span>)  &amp;&amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">containsAllStatesOfBothCa</span> (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">ca1</span>) (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">ca2</span>) (<span class="id" title="var">bisimRelation</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">false</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">areBisimilar</span> (<span class="id" title="var">ca1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">ca2</span>: <span class="id" title="var">constraintAutomata</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">checkBisimilarity</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span> (<span class="id" title="var">bisimulation</span> <span class="id" title="var">ca1</span> <span class="id" title="var">ca2</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">ConstraintAutomata</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">ConstraintAutomata</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">ProductAutomata</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">ProductAutomata</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <span class="id" title="var">state</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span> <span class="id" title="var">state2</span>: <span class="id" title="keyword">Set</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<span class="id" title="var">EqDec</span> <span class="id" title="var">name</span> <span class="id" title="var">eq</span>} `{<span class="id" title="var">EqDec</span> <span class="id" title="var">state</span> <span class="id" title="var">eq</span>} `{<span class="id" title="var">EqDec</span> <span class="id" title="var">state2</span> <span class="id" title="var">eq</span>} `{<span class="id" title="var">EqDec</span> (<span class="id" title="var">data</span>) <span class="id" title="var">eq</span>}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">constraintAutomata</span>  := <span class="id" title="var">ConstraintAutomata.constraintAutomata</span> <span class="id" title="var">state</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">constraintAutomata2</span> := <span class="id" title="var">ConstraintAutomata.constraintAutomata</span> <span class="id" title="var">state2</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">DC</span> := <span class="id" title="var">ConstraintAutomata.DC</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">statesSet</span> (<span class="id" title="var">a1</span>:<span class="id" title="var">ConstraintAutomata.constraintAutomata</span> <span class="id" title="var">state</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>) (<span class="id" title="var">a2</span>:<span class="id" title="var">ConstraintAutomata.constraintAutomata</span> <span class="id" title="var">state2</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">list_prod</span> (<span class="id" title="var">ConstraintAutomata.Q</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">ConstraintAutomata.Q</span> <span class="id" title="var">a2</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">statesSetSound</span> :<span class="id" title="keyword">forall</span> <span class="id" title="var">a1</span>,<span class="id" title="keyword">forall</span> <span class="id" title="var">a2</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">In</span> (<span class="id" title="var">a</span>,<span class="id" title="var">b</span>) (<span class="id" title="var">statesSet</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">a</span> (<span class="id" title="var">ConstraintAutomata.Q</span> <span class="id" title="var">a1</span>) /\ <span class="id" title="var">In</span> <span class="id" title="var">b</span> (<span class="id" title="var">ConstraintAutomata.Q</span> <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_prod_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">nameSet</span> (<span class="id" title="var">a1</span>:<span class="id" title="var">ConstraintAutomata.constraintAutomata</span> <span class="id" title="var">state</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>) (<span class="id" title="var">a2</span>:<span class="id" title="var">ConstraintAutomata.constraintAutomata</span> <span class="id" title="var">state2</span> <span class="id" title="var">name</span> <span class="id" title="var">data</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_union</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">a2</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nameSetSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a1</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a2</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">a</span> (<span class="id" title="var">nameSet</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">a</span> (<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">a1</span>) \/ <span class="id" title="var">In</span> <span class="id" title="var">a</span> (<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_union_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">initialStates</span> (<span class="id" title="var">a1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">a2</span>: <span class="id" title="var">constraintAutomata2</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">list_prod</span> (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">a2</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">initialStatesSound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a1</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a2</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">In</span> (<span class="id" title="var">a</span>,<span class="id" title="var">b</span>) (<span class="id" title="var">initialStates</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">a</span> (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">a1</span>) /\ <span class="id" title="var">In</span> <span class="id" title="var">b</span> (<span class="id" title="var">ConstraintAutomata.Q0</span> <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_prod_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">condR1</span> (<span class="id" title="var">t1</span> : ( <span class="id" title="tactic">set</span>(<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * <span class="id" title="var">state</span>)) (<span class="id" title="var">t2</span> : (<span class="id" title="tactic">set</span>(<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * <span class="id" title="var">state2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">names1</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">names2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_eq</span> (<span class="id" title="var">set_inter</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">names2</span>) (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">t1</span>)))) (<span class="id" title="var">set_inter</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">names1</span>) (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">t2</span>)))).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">condR1Sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">t2</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">names1</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">names2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">condR1</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">names1</span> <span class="id" title="var">names2</span> = <span class="id" title="var">true</span> &lt;-&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_eq</span> (<span class="id" title="var">set_inter</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">names2</span>) (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">t1</span>)))) (<span class="id" title="var">set_inter</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">names1</span>) (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">t2</span>)))) = <span class="id" title="var">true</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">condR1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">set_eq</span> (<span class="id" title="var">set_inter</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="var">names2</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">fst</span> <span class="id" title="var">t1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">set_inter</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="var">names1</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">fst</span> <span class="id" title="var">t2</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">condR1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">condR1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">singleTransitionR1</span> (<span class="id" title="var">Q1</span>: <span class="id" title="var">state</span>) (<span class="id" title="var">Q2</span>: <span class="id" title="var">state2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transition1</span>: (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transition2</span>: (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state2</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">names1</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">names2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) :  (<span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span> * ((<span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="var">DC</span>) * (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span>)))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">condR1</span> (<span class="id" title="var">transition1</span>) (<span class="id" title="var">transition2</span>) (<span class="id" title="var">names1</span>) (<span class="id" title="var">names2</span>)) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[((<span class="id" title="var">Q1</span>,<span class="id" title="var">Q2</span>),(((<span class="id" title="var">set_union</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">transition1</span>))) (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">transition2</span>)))),<span class="id" title="var">ConstraintAutomata.andDc</span> (<span class="id" title="var">snd</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">transition1</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">snd</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">transition2</span>)))),(<span class="id" title="var">snd</span>(<span class="id" title="var">transition1</span>) , (<span class="id" title="var">snd</span>(<span class="id" title="var">transition2</span>)))))]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> [].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">singleTransitionR1Sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">Q1</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">Q2</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">transition1</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">transition2</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">names1</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">names2</span>, <span class="id" title="var">singleTransitionR1</span> <span class="id" title="var">Q1</span> <span class="id" title="var">Q2</span> <span class="id" title="var">transition1</span> <span class="id" title="var">transition2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">names1</span> <span class="id" title="var">names2</span> &lt;&gt; [] &lt;-&gt; (<span class="id" title="var">condR1</span> (<span class="id" title="var">transition1</span>) (<span class="id" title="var">transition2</span>) (<span class="id" title="var">names1</span>) (<span class="id" title="var">names2</span>)) = <span class="id" title="var">true</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">singleTransitionR1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">condR1</span> (<span class="id" title="var">transition1</span>) (<span class="id" title="var">transition2</span>) (<span class="id" title="var">names1</span>) (<span class="id" title="var">names2</span>)). <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">singleTransitionR1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">moreTransitionsR1</span> (<span class="id" title="var">Q1</span>: <span class="id" title="var">state</span>) (<span class="id" title="var">Q2</span>: <span class="id" title="var">state2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transition1</span>: (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transition2</span>: <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state2</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">names1</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">names2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">transition2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; (<span class="id" title="var">singleTransitionR1</span> <span class="id" title="var">Q1</span> <span class="id" title="var">Q2</span> <span class="id" title="var">transition1</span> <span class="id" title="var">a</span> <span class="id" title="var">names1</span> <span class="id" title="var">names2</span>)++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">moreTransitionsR1</span> <span class="id" title="var">Q1</span> <span class="id" title="var">Q2</span> <span class="id" title="var">transition1</span> <span class="id" title="var">t</span> <span class="id" title="var">names1</span> <span class="id" title="var">names2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">transitionsForOneStateR1</span> (<span class="id" title="var">Q1</span>: <span class="id" title="var">state</span>) (<span class="id" title="var">Q2</span>: <span class="id" title="var">state2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transition1</span>: <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transition2</span>: <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state2</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">names1</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">names2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">transition1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; (<span class="id" title="var">moreTransitionsR1</span> <span class="id" title="var">Q1</span> <span class="id" title="var">Q2</span> <span class="id" title="var">a</span> <span class="id" title="var">transition2</span> <span class="id" title="var">names1</span> <span class="id" title="var">names2</span>)++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transitionsForOneStateR1</span> <span class="id" title="var">Q1</span> <span class="id" title="var">Q2</span> <span class="id" title="var">t</span> <span class="id" title="var">transition2</span> <span class="id" title="var">names1</span> <span class="id" title="var">names2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">iterateOverA2R1</span> (<span class="id" title="var">Q1</span>: <span class="id" title="var">state</span>) (<span class="id" title="var">Q2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">state2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transition1</span>: <span class="id" title="var">state</span> -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transition2</span>: <span class="id" title="var">state2</span> -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state2</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">names1</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">names2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Q2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; (<span class="id" title="var">transitionsForOneStateR1</span> <span class="id" title="var">Q1</span> <span class="id" title="var">a</span> (<span class="id" title="var">transition1</span> <span class="id" title="var">Q1</span>) (<span class="id" title="var">transition2</span> <span class="id" title="var">a</span>) <span class="id" title="var">names1</span> <span class="id" title="var">names2</span>)++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">iterateOverA2R1</span> <span class="id" title="var">Q1</span> <span class="id" title="var">t</span> <span class="id" title="var">transition1</span> <span class="id" title="var">transition2</span> <span class="id" title="var">names1</span> <span class="id" title="var">names2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">allTransitionsR1</span> (<span class="id" title="var">Q1</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) (<span class="id" title="var">Q2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">state2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transition1</span>: <span class="id" title="var">state</span> -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transition2</span>: <span class="id" title="var">state2</span> -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state2</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">names1</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">names2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Q1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; (<span class="id" title="var">iterateOverA2R1</span> <span class="id" title="var">a</span> <span class="id" title="var">Q2</span> <span class="id" title="var">transition1</span> <span class="id" title="var">transition2</span> <span class="id" title="var">names1</span> <span class="id" title="var">names2</span>)++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">allTransitionsR1</span> <span class="id" title="var">t</span> <span class="id" title="var">Q2</span> <span class="id" title="var">transition1</span> <span class="id" title="var">transition2</span> <span class="id" title="var">names1</span> <span class="id" title="var">names2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">transitionsRule1</span> (<span class="id" title="var">a1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">a2</span>: <span class="id" title="var">constraintAutomata2</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">allTransitionsR1</span> (<span class="id" title="var">ConstraintAutomata.Q</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">ConstraintAutomata.Q</span> <span class="id" title="var">a2</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ConstraintAutomata.T</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">ConstraintAutomata.T</span> <span class="id" title="var">a2</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">a2</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">condR2</span> (<span class="id" title="var">tr</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * <span class="id" title="var">state</span>) (<span class="id" title="var">names2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">set_inter</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">tr</span>))) <span class="id" title="var">names2</span>) == <span class="id" title="var">nil</span> <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">condR2Sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">tr</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">names2</span>, <span class="id" title="var">condR2</span> <span class="id" title="var">tr</span> <span class="id" title="var">names2</span> = <span class="id" title="var">true</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_inter</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">tr</span>))) <span class="id" title="var">names2</span> = <span class="id" title="var">nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">condR2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">condR2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">singleTransitionR2</span> (<span class="id" title="var">q1</span>:<span class="id" title="var">state</span>) (<span class="id" title="var">transition</span> : (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state</span>))) (<span class="id" title="var">a2States</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">state2</span>) (<span class="id" title="var">a2Names</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>)   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span> * ((<span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="var">DC</span>) * (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span>))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a2States</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">q2</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">condR2</span> (<span class="id" title="var">transition</span>) (<span class="id" title="var">a2Names</span>)) <span class="id" title="keyword">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">q1</span>,<span class="id" title="var">q2</span>),((<span class="id" title="var">fst</span>(<span class="id" title="var">transition</span>)), ((<span class="id" title="var">snd</span>(<span class="id" title="var">transition</span>)), (<span class="id" title="var">q2</span>))))::<span class="id" title="var">singleTransitionR2</span> <span class="id" title="var">q1</span> <span class="id" title="var">transition</span> <span class="id" title="var">t</span> <span class="id" title="var">a2Names</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">singleTransitionR2</span> <span class="id" title="var">q1</span> <span class="id" title="var">transition</span> <span class="id" title="var">t</span> <span class="id" title="var">a2Names</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">singleTransitionR2Sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">transition</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a2States</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a2Names</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">singleTransitionR2</span> <span class="id" title="var">q1</span> <span class="id" title="var">transition</span> <span class="id" title="var">a2States</span> <span class="id" title="var">a2Names</span> &lt;&gt; [] &lt;-&gt; <span class="id" title="var">condR2</span> (<span class="id" title="var">transition</span>) (<span class="id" title="var">a2Names</span>) = <span class="id" title="var">true</span> /\ <span class="id" title="var">a2States</span> &lt;&gt; [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">a2States</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">singleTransitionR2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">condR2</span> <span class="id" title="var">transition</span> <span class="id" title="var">a2Names</span>). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2States</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">a2States</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">singleTransitionR2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">condR2</span> <span class="id" title="var">transition</span> <span class="id" title="var">a2Names</span>). <span class="id" title="tactic">discriminate</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">transitionR2</span> (<span class="id" title="var">q1</span>:<span class="id" title="var">state</span>) : <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state</span>)) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">state2</span> -&gt; <span class="id" title="tactic">set</span> <span class="id" title="var">name</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span> * ((<span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="var">DC</span>) * (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span>))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">transitions</span> <span class="id" title="var">q2</span> <span class="id" title="var">names2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">transitions</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; [] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt;  (<span class="id" title="var">singleTransitionR2</span> <span class="id" title="var">q1</span> <span class="id" title="var">a</span> <span class="id" title="var">q2</span> <span class="id" title="var">names2</span>)++(<span class="id" title="keyword">rec</span> <span class="id" title="var">t</span> <span class="id" title="var">q2</span> <span class="id" title="var">names2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">allTransitionsR2</span> (<span class="id" title="var">Q1</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) (<span class="id" title="var">transitions</span>: <span class="id" title="var">state</span> -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">names2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">a2States</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">state2</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Q1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; (<span class="id" title="var">transitionR2</span> <span class="id" title="var">a</span> (<span class="id" title="var">transitions</span>(<span class="id" title="var">a</span>)) <span class="id" title="var">a2States</span> <span class="id" title="var">names2</span>)++(<span class="id" title="var">allTransitionsR2</span> <span class="id" title="var">t</span> <span class="id" title="var">transitions</span> <span class="id" title="var">names2</span> <span class="id" title="var">a2States</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">transitionsRule2</span> (<span class="id" title="var">a1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">a2</span> : <span class="id" title="var">constraintAutomata2</span>)  :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">allTransitionsR2</span> (<span class="id" title="var">ConstraintAutomata.Q</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">ConstraintAutomata.T</span> <span class="id" title="var">a1</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">a2</span>) (<span class="id" title="var">ConstraintAutomata.Q</span> <span class="id" title="var">a2</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">condR3</span> (<span class="id" title="var">tr</span>: <span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * <span class="id" title="var">state2</span>) (<span class="id" title="var">names1</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">set_inter</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">tr</span>))) <span class="id" title="var">names1</span>) == <span class="id" title="var">nil</span> <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">condR3Sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">tr</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">names1</span>, <span class="id" title="var">condR3</span> <span class="id" title="var">tr</span> <span class="id" title="var">names1</span> = <span class="id" title="var">true</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_inter</span> <span class="id" title="var">equiv_dec</span> (<span class="id" title="var">fst</span>(<span class="id" title="var">fst</span>(<span class="id" title="var">tr</span>))) <span class="id" title="var">names1</span> = <span class="id" title="var">nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">condR3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">condR3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">singleTransitionR3</span> (<span class="id" title="var">q2</span>:<span class="id" title="var">state2</span>) (<span class="id" title="var">transition</span> : (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state2</span>))) (<span class="id" title="var">a2States</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) (<span class="id" title="var">a1Names</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>)   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span> * ((<span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="var">DC</span>) * (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span>))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a2States</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">q1</span>::<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">condR3</span> (<span class="id" title="var">transition</span>) (<span class="id" title="var">a1Names</span>)) <span class="id" title="keyword">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">q1</span>,<span class="id" title="var">q2</span>),((<span class="id" title="var">fst</span>(<span class="id" title="var">transition</span>)), ((<span class="id" title="var">q1</span>) , (<span class="id" title="var">snd</span>(<span class="id" title="var">transition</span>)))))::<span class="id" title="var">singleTransitionR3</span> <span class="id" title="var">q2</span> <span class="id" title="var">transition</span> <span class="id" title="var">t</span> <span class="id" title="var">a1Names</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">singleTransitionR3</span> <span class="id" title="var">q2</span> <span class="id" title="var">transition</span> <span class="id" title="var">t</span> <span class="id" title="var">a1Names</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">singleTransitionR3Sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">q2</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">transition</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a1States</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">a1Names</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">singleTransitionR3</span> <span class="id" title="var">q2</span> <span class="id" title="var">transition</span> <span class="id" title="var">a1States</span> <span class="id" title="var">a1Names</span> &lt;&gt; [] &lt;-&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">condR3</span> (<span class="id" title="var">transition</span>) (<span class="id" title="var">a1Names</span>) = <span class="id" title="var">true</span> /\ <span class="id" title="var">a1States</span> &lt;&gt; [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">a1States</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">condR3</span> (<span class="id" title="var">transition</span>) (<span class="id" title="var">a1Names</span>)). <span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa1States</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">a1States</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="var">case_eq</span> (<span class="id" title="var">condR3</span> (<span class="id" title="var">transition</span>) (<span class="id" title="var">a1Names</span>)). <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">transitionR3</span> (<span class="id" title="var">q2</span>:<span class="id" title="var">state2</span>) : <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state2</span>)) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">state</span> -&gt; <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span> * ((<span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="var">DC</span>) * (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span>))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">transitions</span> <span class="id" title="var">q1</span> <span class="id" title="var">names1</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">transitions</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; [] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt;  (<span class="id" title="var">singleTransitionR3</span> <span class="id" title="var">q2</span> <span class="id" title="var">a</span> <span class="id" title="var">q1</span> <span class="id" title="var">names1</span>)++(<span class="id" title="keyword">rec</span> <span class="id" title="var">t</span> <span class="id" title="var">q1</span> <span class="id" title="var">names1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">allTransitionsR3</span> (<span class="id" title="var">Q2</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">state2</span>) (<span class="id" title="var">transitions</span>: <span class="id" title="var">state2</span> -&gt; <span class="id" title="tactic">set</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">name</span>) * <span class="id" title="var">DC</span> * (<span class="id" title="var">state2</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">names1</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">name</span>) (<span class="id" title="var">a1States</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">state</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Q2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">t</span> =&gt; (<span class="id" title="var">transitionR3</span> <span class="id" title="var">a</span> (<span class="id" title="var">transitions</span>(<span class="id" title="var">a</span>)) <span class="id" title="var">a1States</span> <span class="id" title="var">names1</span>)++(<span class="id" title="var">allTransitionsR3</span> <span class="id" title="var">t</span> <span class="id" title="var">transitions</span> <span class="id" title="var">names1</span> <span class="id" title="var">a1States</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">transitionsRule3</span> (<span class="id" title="var">a1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">a2</span> : <span class="id" title="var">constraintAutomata2</span>)  :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">allTransitionsR3</span> (<span class="id" title="var">ConstraintAutomata.Q</span> <span class="id" title="var">a2</span>) (<span class="id" title="var">ConstraintAutomata.T</span> <span class="id" title="var">a2</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ConstraintAutomata.N</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">ConstraintAutomata.Q</span> <span class="id" title="var">a1</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">buildTransitionRuleProductAutomaton</span> (<span class="id" title="var">a1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">a2</span>: <span class="id" title="var">constraintAutomata2</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transitionsRule1</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>)++(<span class="id" title="var">transitionsRule2</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>)++(<span class="id" title="var">transitionsRule3</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">recoverResultingStatesPA</span> (<span class="id" title="var">st</span>: (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">t</span>:<span class="id" title="tactic">set</span> (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span> * ((<span class="id" title="tactic">set</span> <span class="id" title="var">name</span> * <span class="id" title="var">DC</span>) * (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span>)))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">tx</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">st</span> == <span class="id" title="var">fst</span>((<span class="id" title="var">a</span>)) <span class="id" title="keyword">then</span> (<span class="id" title="var">snd</span>((<span class="id" title="var">a</span>))::<span class="id" title="var">recoverResultingStatesPA</span> <span class="id" title="var">st</span> <span class="id" title="var">tx</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">recoverResultingStatesPA</span> <span class="id" title="var">st</span> <span class="id" title="var">tx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">recoverResultingStatesPASound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span>, <span class="id" title="var">recoverResultingStatesPA</span> <span class="id" title="var">st</span> <span class="id" title="var">t</span> &lt;&gt; [] &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> /\ <span class="id" title="var">st</span> = <span class="id" title="var">fst</span>(<span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">equiv_dec</span>. <span class="id" title="tactic">discriminate</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">transitionPA</span> (<span class="id" title="var">a1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">a2</span>: <span class="id" title="var">constraintAutomata2</span>) (<span class="id" title="var">s</span>: (<span class="id" title="var">state</span> * <span class="id" title="var">state2</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">recoverResultingStatesPA</span> <span class="id" title="var">s</span> (<span class="id" title="var">buildTransitionRuleProductAutomaton</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">buildPA</span> (<span class="id" title="var">a1</span>: <span class="id" title="var">constraintAutomata</span>) (<span class="id" title="var">a2</span>:<span class="id" title="var">constraintAutomata2</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ConstraintAutomata.CA</span> (<span class="id" title="var">statesSet</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) (<span class="id" title="var">nameSet</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) (<span class="id" title="var">transitionPA</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) (<span class="id" title="var">initialStates</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">ProductAutomata</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">ProductAutomata</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">ListSet</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Classes.EquivDec</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Coq.Program.Program</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">QArith</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Coq.Numbers.BinNums</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>